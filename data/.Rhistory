library(ggmap)
library(ggplot2)
library(dplyr)
library(lubridate)
setwd('/Users/olivier/Dropbox/04. Data Science/Python/Bixi Project/data')
df <- read.csv('OD_2018-08.csv',sep = ',')
df_stat <- read.csv('Stations_2018.csv',sep=',')
df_all = merge(df,df_stat,by.x='start_station_code',by.y='code')
df_all <- df_all %>%
mutate(start_hour = hour(start_date)) %>%
mutate(end_hour = hour(end_date)) %>%
mutate(weekday = weekdays(start_date))
df_wed = df_all %>%
group_by(longitude,latitude,end_hour) %>% tally()
bbox = c(-73.75000,45.414645,-73.463061,45.580000)
map <- get_map(location = bbox, source = "stamen", maptype = "toner-lite")
df_wed = df_all %>%
group_by(longitude,latitude,end_hour) %>% tally()
df_all <- df_all %>%
mutate(start_hour = hour(start_date)) %>%
mutate(end_hour = hour(end_date)) %>%
mutate(weekday = weekdays(start_date))
df_all <- df_all %>%
mutate(start_hour = hour(as.POSIXct(start_date))
library(ggmap)
library(ggplot2)
library(dplyr)
library(lubridate)
df_all <- df_all %>%
mutate(start_hour = hour(start_date))
df_all <- df_all %>%
mutate(start_hour = hour(start_date),
end_hour = hour(end_date),
weekday = weekdays(start_date))
df_all <- df_all %>%
mutate(start_hour = hour(start_date),
end_hour = hour(end_date))
df_wed = df_all %>%
group_by(longitude,latitude,end_hour) %>% tally()
bbox = c(-73.75000,45.414645,-73.463061,45.580000)
map <- get_map(location = bbox, source = "stamen", maptype = "toner-lite")
ggmap(map) +
geom_point(data=subset(df_wed,end_hour %in% c(18)), aes(x=longitude,y=latitude, alpha = n), color = "#ed9add",size=0.8)
ggmap(map) +
geom_point(data=subset(df_wed,end_hour %in% c(18)), aes(x=longitude,y=latitude, alpha = n), color = "#ed9add",size=0.8, show.legend = F)
ggmap(map) +
geom_point(data=subset(df_wed,end_hour %in% c(dhour)), aes(x=longitude,y=latitude, alpha = n), color = "#ed9add",size=0.8, show.legend = F) +
theme(axis.title.x = element_blank())
ggmap(map) +
geom_point(data=subset(df_wed,end_hour %in% c(18)), aes(x=longitude,y=latitude, alpha = n), color = "#ed9add",size=0.8, show.legend = F) +
theme(axis.title.x = element_blank())
ggmap(map) +
geom_point(data=subset(df_wed,end_hour %in% c(18)), aes(x=longitude,y=latitude, alpha = n), color = "#ed9add",size=0.8, show.legend = F) +
theme(axis.title.x = element_blank(),axis.title.y = element_blank())
ggmap(map) +
geom_point(data=subset(df_wed,end_hour %in% c(18)), aes(x=longitude,y=latitude, alpha = n), color = "#ed9add",size=0.8, show.legend = F) +
theme(axis.title.x = element_blank(),axis.title.y = element_blank(), axis.line.x = element_blank())
ggmap(map) +
geom_point(data=subset(df_wed,end_hour %in% c(18)), aes(x=longitude,y=latitude, alpha = n), color = "#ed9add",size=0.8, show.legend = F) +
theme(axis.title.x = element_blank(),axis.title.y = element_blank(), axis.line.x = element_blank(), axis.line.y =element_blank(),axis.text.x = element_blank(),axis.ticks.y = element_blank())
ggmap(map) +
geom_point(data=subset(df_wed,end_hour %in% c(18)), aes(x=longitude,y=latitude, alpha = n), color = "#ed9add",size=0.8, show.legend = F) +
theme(axis.title.x = element_blank(),axis.title.y = element_blank(), axis.line.x = element_blank(), axis.line.y =element_blank(),axis.text.x = element_blank(),axis.ticks.y = element_blank(),axis.text.y = element_blank())
ggmap(map) +
geom_point(data=subset(df_wed,end_hour %in% c(18)), aes(x=longitude,y=latitude, alpha = n), color = "#ed9add",size=0.8, show.legend = F) +
theme(axis.title.x = element_blank(),axis.title.y = element_blank(), axis.line.x = element_blank(), axis.line.y =element_blank(),axis.text.x = element_blank(),axis.ticks.y = element_blank(),axis.text.y = element_blank(),axis.ticks.x = element_blank())
for (dhour in c(seq(0,23))){
ggmap(map) +
geom_point(data=subset(df_wed,end_hour %in% c(18)), aes(x=longitude,y=latitude, alpha = n), color = "#ed9add",size=0.8, show.legend = F) +
theme(axis.title.x = element_blank(),axis.title.y = element_blank(), axis.line.x = element_blank(), axis.line.y =element_blank(),axis.text.x = element_blank(),axis.ticks.y = element_blank(),axis.text.y = element_blank(),axis.ticks.x = element_blank())
fn <- paste('../img/bixi_end',dhour,'.png',sep='')
ggsave(fn)
}
for (dhour in c(seq(0,23))){
ggmap(map) +
geom_point(data=subset(df_wed,end_hour %in% c(dhour)), aes(x=longitude,y=latitude, alpha = n), color = "#ed9add",size=0.8, show.legend = F) +
theme(axis.title.x = element_blank(),axis.title.y = element_blank(), axis.line.x = element_blank(), axis.line.y =element_blank(),axis.text.x = element_blank(),axis.ticks.y = element_blank(),axis.text.y = element_blank(),axis.ticks.x = element_blank())
fn <- paste('../img/bixi_end',dhour,'.png',sep='')
ggsave(fn)
}
